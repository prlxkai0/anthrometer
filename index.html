<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AnthroMeter / Good Times Index</title>

  <!-- Clean font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Styles + cache bust -->
  <link rel="stylesheet" href="./styles.css?v=restore3" />

  <!-- Plotly + App -->
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js" defer></script>
  <script src="./script.js?v=restore3" defer></script>
</head>
<body>
  <div class="container">
    <header class="topbar">
      <h1 class="brandline">
        <span class="brand">AnthroMeter</span>
        <span class="slash"> / </span>
        <span class="subtitle">Good Times Index</span>
      </h1>
      <div class="top-actions">
        <label class="switch">
          <input id="dark-mode" type="checkbox" />
          <span>Dark</span>
        </label>
        <label class="switch">
          <input id="auto-refresh" type="checkbox" checked />
          <span>Auto</span>
        </label>
        <span id="live-ago" class="live">updated —</span>
      </div>
    </header>

    <!-- KPI header row -->
    <section class="kpis">
      <div class="kpi">
        <div class="kpi-label">Current GTI</div>
        <div class="kpi-val" id="kpi-gti">—</div>
      </div>
      <div class="kpi">
        <div class="kpi-label">Year</div>
        <div class="kpi-val" id="kpi-year">—</div>
      </div>
      <div class="kpi">
        <div class="kpi-label">vs 30-day avg</div>
        <div class="kpi-val" id="kpi-delta">—</div>
      </div>
      <div class="kpi">
        <div class="kpi-label">Last updated</div>
        <div class="kpi-val small" id="kpi-updated">—</div>
      </div>
    </section>

    <!-- Tabs -->
    <nav class="tabs">
      <a href="#" class="tab active" data-tab="overview">Overview</a>
      <a href="#" class="tab" data-tab="details">Details</a>
      <a href="#" class="tab" data-tab="sources">Sources & Methodology</a>
    </nav>

    <main>
      <!-- Overview -->
      <section id="tab-overview" class="tabpanel active">
        <div class="controls">
          <label>Line color
            <select id="line-color">
              <option value="auto" selected>Auto</option>
              <option value="blue">Blue</option>
              <option value="green">Green</option>
              <option value="purple">Purple</option>
              <option value="orange">Orange</option>
              <option value="red">Red</option>
            </select>
          </label>
          <label>Line weight
            <select id="line-weight">
              <option>2</option><option selected>3</option><option>4</option><option>5</option>
            </select>
          </label>
          <label>Range
            <select id="range-select">
              <option value="all" selected>All</option>
              <option value="20y">Last 20y</option>
              <option value="decade">Last 10y</option>
              <option value="5y">Last 5y</option>
            </select>
          </label>
          <button id="btn-png">Export PNG</button>
          <button id="btn-csv">Export CSV</button>
        </div>

        <div id="chart-plot" class="chart">Loading…</div>

        <section id="signals" class="signals">
          <h3>Today’s Signals</h3>
          <ul id="signals-list"></ul>
          <div id="signals-foot" class="muted">Signals compare to recent baselines.</div>
        </section>

        <!-- Year-summary popup (appears on chart click, auto-hides) -->
        <div id="year-summary" class="ys" style="display:none;">
          <button id="ys-close" class="close" aria-label="Close">×</button>
          <div class="ys-title"><span id="ys-year">—</span> • GTI <span id="ys-gti">—</span></div>
          <div class="ys-hover" id="ys-hover">—</div>
          <div class="ys-ai" id="ys-ai">Summary coming soon.</div>
        </div>
      </section>

      <!-- Details -->
      <section id="tab-details" class="tabpanel">
        <div id="category-bars" class="bars"></div>
        <div id="category-table" class="table"></div>
      </section>

      <!-- Sources & Methodology -->
      <section id="tab-sources" class="tabpanel">
        <div id="methodology"></div>
        <div id="sources-list" class="table"></div>
      </section>
    </main>

    <!-- Hidden legacy spans (compat with old code) -->
    <div style="display:none">
      <span id="current-year"></span>
      <span id="current-gti"></span>
      <span id="updated"></span>
    </div>
  </div>
</body>
</html>
